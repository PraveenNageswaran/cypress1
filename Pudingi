I see, if you have a large number of JSON files and you want to process them as they are listed by the `aws s3 ls` command, you can modify the code to directly process the output of the `aws s3 ls` command and construct the JSON structure based on the file names. Here's an example of how you can achieve this in Groovy:

```groovy
def command = ["sh", "-c", "aws s3 ls s3://your-bucket-name/your-folder-name/ --recursive"]

def process = command.execute()
def reader = new BufferedReader(new InputStreamReader(process.getInputStream()))
def output = new StringWriter()
def buffer = new char[1024]
int read

while ((read = reader.read(buffer)) != -1) {
    output.write(buffer, 0, read)
}
reader.close()

def result = output.toString()

// Parse the output to extract object keys
def objectKeys = result.split("\\s+").findAll { it.endsWith("json") } as List

// Construct the JSON structure
def jsonStructure = [
    iso: [
        sourceSystems: objectKeys.collect { objectKey ->
            def folderPath = "c:/misc/ting" // Replace with the actual path
            def parts = objectKey.split(" ")
            def businessDate = parts[0]
            def source = parts[3]
            def s3url = "s3://your-bucket-name/${objectKey}"

            [
                source: source,
                businessDate: businessDate,
                s3url: s3url,
                path: folderPath
            ]
        }
    ]
]

// Convert the JSON structure to a JSON string
String jsonOutput = new groovy.json.JsonBuilder(jsonStructure).toPrettyString()

println(jsonOutput)
```

In this example, the code directly processes the output of the `aws s3 ls` command to extract the object keys of the JSON files. It then constructs the JSON structure based on the extracted object keys.

Replace `"your-bucket-name"` and `"your-folder-name"` with the actual S3 bucket name and folder name.

This code should now be able to handle a large number of JSON files listed by the `aws s3 ls` command and construct a JSON structure based on their file names. If you have any other questions or need further assistance, feel free to ask!
